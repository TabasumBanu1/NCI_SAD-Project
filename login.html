<!DOCTYPE html>
<html>
<head>
  <title>Welcome | Company Portal</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {
      background: linear-gradient(135deg, #57C6E1 0%, #B49FDC 100%);
      font-family: 'Montserrat', Arial, sans-serif;
      min-height: 100vh;
      margin: 0;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .container {
      background: #fff;
      border-radius: 20px;
      box-shadow: 0 8px 32px 0 rgba(31, 38, 135, .20);
      width: 400px;
      max-width: 95vw;
      padding: 2.5rem 2rem 2rem 2rem;
      position: relative;
      text-align: center;
      overflow: hidden;
    }
    .logo {
      width: 70px;
      margin-bottom: 1rem;
    }
    h2 {
      margin: .3rem 0 1.3rem 0;
      letter-spacing: 1px;
      color: #6B47DC;
      font-weight: 800;
      font-size: 1.5rem;
    }
    .tab {
      display: flex;
      justify-content: center;
      margin-bottom: 2rem;
      background: #eee;
      border-radius: 50px;
      overflow: hidden;
      box-shadow: 0 2px 8px #ececec77;
    }
    .tab-btn {
      flex: 1;
      padding: .6rem;
      background: transparent;
      border: none;
      outline: none;
      font-weight: 700;
      color: #6B47DC;
      font-size: 1rem;
      cursor: pointer;
      transition: background .2s;
    }
    .tab-btn.active, .tab-btn:focus {
      background: #6B47DC;
      color: #fff;
    }
    .form-group {
      text-align: left;
      margin-bottom: 1.2rem;
    }
    label {
      display: block;
      margin-bottom: .3rem;
      font-size: .95rem;
      color: #5d5d5d;
      font-weight: 500;
    }
    input, select {
      width: 100%;
      padding: .55rem .75rem;
      font-size: 1rem;
      border-radius: 8px;
      border: 1px solid #e5e5e5;
      transition: border .2s;
      background: #fafaff;
    }
    input:focus, select:focus {
      border: 1.5px solid #6B47DC;
      outline: none;
    }
    .submit-btn {
      width: 100%;
      padding: .75rem;
      border-radius: 12px;
      background: linear-gradient(90deg, #6B47DC 50%, #57C6E1 100%);
      color: #fff;
      font-size: 1.1rem;
      font-weight: 700;
      border: none;
      margin-top: .7rem;
      cursor: pointer;
      box-shadow: 0 4px 12px #b49fdc44;
      transition: background .2s, transform .1s;
    }
    .submit-btn:hover {
      background: linear-gradient(90deg, #57C6E1 40%, #6B47DC 100%);
      transform: scale(1.02);
    }
    .note {
      color: #888;
      font-size: .96rem;
      margin: .6rem 0 0 0;
      text-align: center;
    }
    .status-message {
      margin-top: .7rem;
      color: #e74c3c;
      min-height: 1.2em;
      text-align: center;
    }
    .graphic {
      position: absolute;
      right: -60px; bottom: -60px; z-index: 0;
      width: 180px; opacity: 0.12; pointer-events: none;
      user-select: none;
    }
    @media (max-width: 550px) {
      .container { width: 97vw; padding: 1.3rem .4rem 1.4rem .4rem;}
      .logo { width: 52px;}
      h2 { font-size: 1.1rem; }
      .graphic { width: 100px; right: -22px; bottom: -22px;}
    }
  </style>
  <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700,800&display=swap" rel="stylesheet">
</head>
<body>
  <div class="container">
    <img class="logo" src="https://svgshare.com/i/12Vh.svg" alt="Logo" />
    <h2>Company Careers Portal</h2>
    <div class="tab">
      <button class="tab-btn active" id="loginTab" onclick="showTab('login')">Login</button>
      <button class="tab-btn" id="registerTab" onclick="showTab('register')">Register</button>
    </div>
    <form id="loginForm" autocomplete="off">
      <div class="form-group">
        <label for="login-email">Email</label>
        <input id="login-email" type="email" required placeholder="Enter your email" autocomplete="username">
      </div>
      <div class="form-group">
        <label for="login-password">Password</label>
        <input id="login-password" type="password" required placeholder="Password" autocomplete="current-password">
      </div>
      <button type="submit" class="submit-btn">Login</button>
      <div class="status-message" id="loginStatus"></div>
      <div class="note">Login as Employee, Senior Manager, or Admin</div>
    </form>
    <form id="registerForm" style="display:none" autocomplete="off">
      <div class="form-group">
        <label for="reg-name">Full Name</label>
        <input id="reg-name" required maxlength="100" placeholder="Enter your name">
      </div>
      <div class="form-group">
        <label for="reg-email">Email</label>
        <input id="reg-email" type="email" required maxlength="100" placeholder="Your email">
      </div>
      <div class="form-group">
        <label for="reg-password">Password</label>
        <input id="reg-password" type="password" required minlength="4" maxlength="30" placeholder="Choose a password">
      </div>
      <div class="form-group">
        <label for="reg-role">Role</label>
        <select id="reg-role" required>
          <option value="employee">Employee</option>
          <option value="senior_manager">Senior Manager</option>
        </select>
      </div>
      <button type="submit" class="submit-btn">Register</button>
      <div class="status-message" id="registerStatus"></div>
      <div class="note">* Admins can only be added by IT department</div>
    </form>
    <svg class="graphic" viewBox="0 0 400 400"><circle cx="200" cy="200" r="180" fill="#6B47DC" /><circle cx="270" cy="130" r="80" fill="#57C6E1" /></svg>
  </div>
  <script>
    function showTab(tab) {
      document.getElementById('loginForm').style.display = tab === 'login' ? '' : 'none';
      document.getElementById('registerForm').style.display = tab === 'register' ? '' : 'none';
      document.getElementById('loginTab').classList.toggle('active', tab === 'login');
      document.getElementById('registerTab').classList.toggle('active', tab === 'register');
      document.getElementById('loginStatus').innerText = '';
      document.getElementById('registerStatus').innerText = '';
    }
    document.getElementById('loginForm').onsubmit = async function(e) {
      e.preventDefault();
      let email = document.getElementById('login-email').value.trim();
      let password = document.getElementById('login-password').value;
      document.getElementById('loginStatus').innerText = 'Checking...';
      const res = await fetch('api/login.php', {
        method: 'POST',
        body: JSON.stringify({ email, password })
      });
      const data = await res.json();
      if (data.success) {
        document.getElementById('loginStatus').innerText = '';
        if (data.user.role === "employee")
          window.location.href = "employee_dashboard.html";
        else if (data.user.role === "senior_manager")
          window.location.href = "manager_dashboard.html";
        else if (data.user.role === "admin")
          window.location.href = "admin_dashboard.html";
      } else {
        document.getElementById('loginStatus').innerText = 'Invalid email or password.';
      }
    };
    document.getElementById('registerForm').onsubmit = async function(e) {
      e.preventDefault();
      let name = document.getElementById('reg-name').value.trim();
      let email = document.getElementById('reg-email').value.trim();
      let password = document.getElementById('reg-password').value;
      let role = document.getElementById('reg-role').value;
      document.getElementById('registerStatus').innerText = 'Processing...';
      const res = await fetch('api/register.php', {
        method: 'POST',
        body: JSON.stringify({ name, email, password, role })
      });
      const data = await res.json();
      if (data.success) {
        document.getElementById('registerStatus').style.color = "#12b321";
        document.getElementById('registerStatus').innerText = "Registration successful! Please login.";
        setTimeout(() => { showTab('login'); }, 1200);
      } else {
        document.getElementById('registerStatus').style.color = "#e74c3c";
        document.getElementById('registerStatus').innerText = "Registration failed. Try again.";
      }
    };
  </script>
</body>
</html>